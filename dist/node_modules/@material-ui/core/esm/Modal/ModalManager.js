import"/node_modules/core-js/modules/es.array.index-of.js";import"/node_modules/core-js/modules/es.array.splice.js";import _classCallCheck from"/node_modules/@babel/runtime/helpers/esm/classCallCheck.js";import _createClass from"/node_modules/@babel/runtime/helpers/esm/createClass.js";import _toConsumableArray from"/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js";import getScrollbarSize from"/node_modules/@material-ui/core/esm/utils/getScrollbarSize.js";import ownerDocument from"/node_modules/@material-ui/core/esm/utils/ownerDocument.js";import ownerWindow from"/node_modules/@material-ui/core/esm/utils/ownerWindow.js";function isOverflowing(container){var doc=ownerDocument(container);return doc.body===container?ownerWindow(doc).innerWidth>doc.documentElement.clientWidth:container.scrollHeight>container.clientHeight}export function ariaHidden(node,show){show?node.setAttribute("aria-hidden","true"):node.removeAttribute("aria-hidden")}function getPaddingRight(node){return parseInt(window.getComputedStyle(node)["padding-right"],10)||0}function ariaHiddenSiblings(container,mountNode,currentNode){var nodesToExclude=3<arguments.length&&arguments[3]!==void 0?arguments[3]:[],show=4<arguments.length?arguments[4]:void 0,blacklist=[mountNode,currentNode].concat(_toConsumableArray(nodesToExclude)),blacklistTagNames=["TEMPLATE","SCRIPT","STYLE"];[].forEach.call(container.children,function(node){1===node.nodeType&&-1===blacklist.indexOf(node)&&-1===blacklistTagNames.indexOf(node.tagName)&&ariaHidden(node,show)})}function findIndexOf(containerInfo,callback){var idx=-1;return containerInfo.some(function(item,index){return!!callback(item)&&(idx=index,!0)}),idx}function handleContainer(containerInfo,props){var fixedNodes,restoreStyle=[],restorePaddings=[],container=containerInfo.container;if(!props.disableScrollLock){if(isOverflowing(container)){var scrollbarSize=getScrollbarSize();restoreStyle.push({value:container.style.paddingRight,key:"padding-right",el:container}),container.style["padding-right"]="".concat(getPaddingRight(container)+scrollbarSize,"px"),fixedNodes=ownerDocument(container).querySelectorAll(".mui-fixed"),[].forEach.call(fixedNodes,function(node){restorePaddings.push(node.style.paddingRight),node.style.paddingRight="".concat(getPaddingRight(node)+scrollbarSize,"px")})}var parent=container.parentElement,scrollContainer="HTML"===parent.nodeName&&"scroll"===window.getComputedStyle(parent)["overflow-y"]?parent:container;restoreStyle.push({value:scrollContainer.style.overflow,key:"overflow",el:scrollContainer}),scrollContainer.style.overflow="hidden"}var restore=function restore(){fixedNodes&&[].forEach.call(fixedNodes,function(node,i){restorePaddings[i]?node.style.paddingRight=restorePaddings[i]:node.style.removeProperty("padding-right")}),restoreStyle.forEach(function(_ref){var value=_ref.value,el=_ref.el,key=_ref.key;value?el.style.setProperty(key,value):el.style.removeProperty(key)})};return restore}function getHiddenSiblings(container){var hiddenSiblings=[];return[].forEach.call(container.children,function(node){node.getAttribute&&"true"===node.getAttribute("aria-hidden")&&hiddenSiblings.push(node)}),hiddenSiblings}var ModalManager=function(){function ModalManager(){_classCallCheck(this,ModalManager),this.modals=[],this.containers=[]}return _createClass(ModalManager,[{key:"add",value:function add(modal,container){var modalIndex=this.modals.indexOf(modal);if(-1!==modalIndex)return modalIndex;modalIndex=this.modals.length,this.modals.push(modal),modal.modalRef&&ariaHidden(modal.modalRef,!1);var hiddenSiblingNodes=getHiddenSiblings(container);ariaHiddenSiblings(container,modal.mountNode,modal.modalRef,hiddenSiblingNodes,!0);var containerIndex=findIndexOf(this.containers,function(item){return item.container===container});return-1===containerIndex?(this.containers.push({modals:[modal],container:container,restore:null,hiddenSiblingNodes:hiddenSiblingNodes}),modalIndex):(this.containers[containerIndex].modals.push(modal),modalIndex)}},{key:"mount",value:function mount(modal,props){var containerIndex=findIndexOf(this.containers,function(item){return-1!==item.modals.indexOf(modal)}),containerInfo=this.containers[containerIndex];containerInfo.restore||(containerInfo.restore=handleContainer(containerInfo,props))}},{key:"remove",value:function remove(modal){var modalIndex=this.modals.indexOf(modal);if(-1===modalIndex)return modalIndex;var containerIndex=findIndexOf(this.containers,function(item){return-1!==item.modals.indexOf(modal)}),containerInfo=this.containers[containerIndex];if(containerInfo.modals.splice(containerInfo.modals.indexOf(modal),1),this.modals.splice(modalIndex,1),0===containerInfo.modals.length)containerInfo.restore&&containerInfo.restore(),modal.modalRef&&ariaHidden(modal.modalRef,!0),ariaHiddenSiblings(containerInfo.container,modal.mountNode,modal.modalRef,containerInfo.hiddenSiblingNodes,!1),this.containers.splice(containerIndex,1);else{var nextTop=containerInfo.modals[containerInfo.modals.length-1];nextTop.modalRef&&ariaHidden(nextTop.modalRef,!1)}return modalIndex}},{key:"isTopModal",value:function isTopModal(modal){return 0<this.modals.length&&this.modals[this.modals.length-1]===modal}}]),ModalManager}();export{ModalManager as default};